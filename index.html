<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Fair Discovery: The decentralized, AI-ranked directory of authentic businesses. Free, open, and transparent.">
    <title>Fair Discovery Directory</title>
    
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%231a73e8'/%3E%3Ccircle cx='42' cy='42' r='24' stroke='white' stroke-width='12' fill='none'/%3E%3Cline x1='60' y1='60' x2='85' y2='85' stroke='white' stroke-width='12' stroke-linecap='round'/%3E%3C/svg%3E">
    
    <style>
        /* --- THEME VARIABLES --- */
        :root {
            --primary: #1a73e8; --bg: #f0f2f5; --card-bg: #ffffff;
            --text: #1f1f1f; --text-sub: #5f6368; --border: #dadce0;
            --success: #1e8e3e; --badge-bg: #e8f0fe;
        }

        [data-theme="dark"] {
            --primary: #8ab4f8; --bg: #202124; --card-bg: #303134;
            --text: #e8eaed; --text-sub: #9aa0a6; --border: #3c4043;
            --success: #81c995; --badge-bg: #3c4043;
        }

        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 0; display: flex; flex-direction: column; min-height: 100vh; transition: background 0.3s; }

        /* HEADER */
        header { 
            background: linear-gradient(180deg, var(--card-bg) 0%, var(--bg) 100%);
            padding: 60px 20px 40px; 
            border-bottom: 1px solid var(--border); 
            position: relative; 
            text-align: center; 
        }

        .header-controls { 
            position: absolute; 
            top: 20px; 
            right: 20px; 
            display: flex; 
            gap: 10px; 
            align-items: center; 
        }

        .theme-toggle, .lang-select { 
            background: var(--card-bg); border: 1px solid var(--border); color: var(--text); 
            padding: 6px 12px; border-radius: 20px; cursor: pointer; font-size: 0.85rem; transition: 0.2s; 
            outline: none;
        }
        .theme-toggle:hover, .lang-select:hover { background: var(--bg); }

        h1 { 
            margin: 0 auto 10px; 
            font-size: 2.5rem; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            gap: 10px; 
            letter-spacing: -1px;
        }
        h1 span { font-weight: 300; opacity: 0.8; }
        
        .subtitle { 
            color: var(--text-sub); 
            margin-bottom: 35px; 
            font-size: 1.1rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* SEARCH & CATEGORIES */
        .search-container { max-width: 584px; margin: 0 auto 25px; }
        input {
            width: 100%; padding: 14px 24px; border-radius: 50px; border: 1px solid var(--border);
            background: var(--card-bg); color: var(--text); font-size: 1.1rem; outline: none; box-sizing: border-box;
            transition: all 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        input:focus { border-color: var(--primary); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }

        .categories { 
            display: flex; gap: 10px; overflow-x: auto; padding: 5px 0 15px; 
            max-width: 1000px; margin: 0 auto; justify-content: center; scrollbar-width: none; 
        }
        .cat-pill {
            white-space: nowrap; padding: 8px 16px; background: var(--card-bg); 
            border: 1px solid var(--border); border-radius: 20px; font-size: 0.9rem; 
            cursor: pointer; color: var(--text-sub); transition: 0.2s;
        }
        .cat-pill:hover, .cat-pill.active { background: var(--badge-bg); color: var(--primary); border-color: var(--primary); }

        /* GRID LAYOUT */
        .container { max-width: 1000px; margin: 20px auto; padding: 0 20px; flex: 1; width: 100%; box-sizing: border-box; }
        .stats-bar { display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--text-sub); margin-bottom: 15px; }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        
        /* CARD STYLING */
        .card {
            background: var(--card-bg); border-radius: 12px; padding: 20px;
            border: 1px solid var(--border); display: flex; flex-direction: column; gap: 12px;
            transition: transform 0.2s, box-shadow 0.2s; position: relative; overflow: hidden;
        }
        .card:hover { transform: translateY(-3px); box-shadow: 0 8px 24px rgba(0,0,0,0.08); border-color: var(--primary); }

        .card-header { display: flex; justify-content: space-between; align-items: flex-start; }
        .card-brand { display: flex; align-items: center; gap: 10px; flex: 1; min-width: 0; }
        .card-logo { width: 40px; height: 40px; background: var(--bg); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0; border: 1px solid var(--border); }
        
        .card-text { min-width: 0; flex: 1; }
        .card-title { font-size: 1.1rem; font-weight: 600; color: var(--text); text-decoration: none; margin: 0; line-height: 1.2; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block; }
        .card-title:hover { text-decoration: underline; }
        .card-domain { font-size: 0.8rem; color: var(--text-sub); display: block; margin-top: 2px; }
        
        .verified-badge { font-size: 0.75rem; color: var(--success); background: rgba(30,142,62,0.1); padding: 2px 6px; border-radius: 4px; display: inline-block; margin-top: 4px; }

        .card-desc { font-size: 0.9rem; color: var(--text-sub); line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

        .card-footer { margin-top: auto; padding-top: 15px; border-top: 1px solid var(--bg); display: flex; justify-content: space-between; align-items: center; }
        
        .score-box { text-align: right; }
        .score-val { font-weight: 700; color: var(--primary); font-size: 1.2rem; }
        .score-lbl { font-size: 0.7rem; color: var(--text-sub); text-transform: uppercase; }

        .actions { display: flex; gap: 8px; }
        .btn-icon { width: 32px; height: 32px; border-radius: 50%; border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; text-decoration: none; color: var(--text-sub); transition: 0.2s; }
        .btn-icon:hover { background: var(--bg); color: var(--primary); border-color: var(--primary); }
        .btn-whatsapp { color: #25D366; border-color: #25D366; }
        .btn-whatsapp:hover { background: #25D366; color: white; }

        /* PAGINATION */
        .pagination { display: flex; justify-content: center; gap: 5px; margin: 40px 0; }
        .page-btn { background: var(--card-bg); border: 1px solid var(--border); padding: 8px 12px; border-radius: 6px; cursor: pointer; color: var(--text); }
        .page-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* WIDGET SECTION */
        .widget-box {
            max-width: 800px; margin: 60px auto 20px; padding: 30px; 
            background: var(--card-bg); border-radius: 12px; border: 1px solid var(--border); 
            text-align: center;
        }
        .widget-preview { margin: 20px 0; }
        .code-area { position: relative; max-width: 500px; margin: 0 auto; }
        textarea {
            width: 100%; height: 80px; padding: 10px; background: var(--bg); 
            border: 1px solid var(--border); border-radius: 8px; font-family: monospace; 
            font-size: 0.8rem; color: var(--text-sub); resize: none; box-sizing: border-box;
        }
        .copy-btn { margin-top: 10px; background: var(--primary); color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 0.9rem; font-weight: 600; }

        /* FOOTER */
        footer { text-align: center; padding: 40px 20px; color: var(--text-sub); font-size: 0.9rem; border-top: 1px solid var(--border); background: var(--card-bg); }
        .footer-desc { max-width: 700px; margin: 0 auto 15px; line-height: 1.6; }
        .api-link { color: var(--primary); font-weight: 600; text-decoration: none; }
        .credits { margin-top: 30px; font-size: 0.8rem; opacity: 0.8; }
        .credits a { color: var(--text-sub); text-decoration: none; margin: 0 5px; }
        .credits a:hover { text-decoration: underline; color: var(--primary); }
        
        @media (max-width: 600px) {
            .grid { grid-template-columns: 1fr; }
            header { padding-top: 80px; } 
            .header-controls { top: 15px; right: 15px; }
            h1 { font-size: 2rem; }
            .categories { justify-content: flex-start; padding-bottom: 10px; }
        }
    </style>
</head>
<body>

<header>
    <div class="header-controls">
        <select class="lang-select" onchange="changeLanguage(this.value)">
            <option value="en">üá∫üá∏ English</option>
            <option value="es">üá™üá∏ Espa√±ol</option>
            <option value="fr">üá´üá∑ Fran√ßais</option>
            <option value="de">üá©üá™ Deutsch</option>
            <option value="pt">üáßüá∑ Portugu√™s</option>
        </select>
        <button class="theme-toggle" onclick="toggleTheme()" data-i18n="theme">üåô Theme</button>
    </div>

    <h1>Fair <span>Discovery</span></h1>
    <p class="subtitle" data-i18n="subtitle">The directory ranked by real humans, not bots.</p>

    <div class="search-container">
        <input type="text" id="searchInput" data-i18n-ph="search_ph" placeholder="Try 'auto cape town' or 'tech services'...">
    </div>

    <div class="categories" id="catFilters">
        <div class="cat-pill active" onclick="filterCat('all')" data-i18n="cat_all">All</div>
        <div class="cat-pill" onclick="filterCat('Auto')" data-i18n="cat_auto">üöó Auto</div>
        <div class="cat-pill" onclick="filterCat('Tech')" data-i18n="cat_tech">üíª Tech</div>
        <div class="cat-pill" onclick="filterCat('Health')" data-i18n="cat_health">üè• Health</div>
        <div class="cat-pill" onclick="filterCat('Service')" data-i18n="cat_service">üõ†Ô∏è Services</div>
        <div class="cat-pill" onclick="filterCat('Retail')" data-i18n="cat_retail">üõçÔ∏è Retail</div>
        <div class="cat-pill" onclick="filterCat('Artists')" data-i18n="cat_artists">üé® Artists</div>
    </div>
</header>

<div class="container">
    <div class="stats-bar">
        <span id="statsLabel">Loading...</span>
        <span data-i18n="global_feed">Global Feed</span>
    </div>
    
    <div id="resultsGrid" class="grid"></div>
    <div class="pagination" id="paginationControls"></div>

    <div class="widget-box">
        <h3 style="margin-top: 0; color: var(--text);" data-i18n="badge_title">üèÜ Show off your Authority</h3>
        <p style="color: var(--text-sub); font-size: 0.95rem;" data-i18n="badge_desc">Are you listed? Add the Fair Discovery seal to your website footer to build trust.</p>
        
        <div class="widget-preview">
            <a href="https://fairdiscovery.org" target="_blank" style="text-decoration: none; display: inline-flex; align-items: center; gap: 8px; background: #fff; border: 1px solid #dfe1e5; padding: 6px 12px; border-radius: 50px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); font-family: sans-serif; color: #333; font-size: 0.85rem; font-weight: 600;">
                <img src="https://fairdiscovery.org/favicon.ico" alt="" style="width: 16px; height: 16px;">
                <span>Verified on Fair Discovery</span>
            </a>
        </div>

        <div class="code-area">
            <textarea id="badgeCode" readonly><a href="https://fairdiscovery.org" target="_blank" style="text-decoration: none; display: inline-flex; align-items: center; gap: 8px; background: #fff; border: 1px solid #dfe1e5; padding: 6px 12px; border-radius: 50px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); font-family: sans-serif; color: #333; font-size: 13px; font-weight: 600;"><span>üõ°Ô∏è Verified on Fair Discovery</span></a></textarea>
            <button class="copy-btn" onclick="copyBadge()" data-i18n="copy_code">Copy Code</button>
        </div>
    </div>
</div>

<footer>
    <p class="footer-desc" data-i18n="footer_desc">
        Fair Discovery ranks websites based on <strong>verified human interaction</strong>, blocking bots to reveal true authority. 
        This forces ad networks to deliver real traffic, not fake clicks‚Äîprotecting your budget and ensuring fair play.
    </p>

    <p>üöÄ <a href="data.json" target="_blank" class="api-link" data-i18n="footer_api">Get the JSON API</a></p>
    <p>üöÄ <a href="https://github.com/fair-collective/fair-discovery/tree/main" target="_blank" class="api-link" data-i18n="footer_join">Join Free on GitHub</a></p>
    
    <div style="margin: 25px 0;">
        <a href="https://www.buymeacoffee.com/Prinymity" target="_blank" style="text-decoration:none;">
            <span style="background:#FFDD00; color:black; padding:8px 16px; border-radius:6px; font-weight:bold; font-size:0.9rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">‚òï <span data-i18n="support">Support the Dev</span></span>
        </a>
    </div>

    <div class="credits">
        Powered by <a href="https://gemini.google.com" target="_blank">Gemini</a> ‚Ä¢ 
        <a href="https://github.com" target="_blank">GitHub</a> ‚Ä¢ 
        <a href="https://github.com/fair-collective" target="_blank">The Fair Collective</a>
    </div>
</footer>

<script>
    const FEED_URL = 'data.json'; 
    let allData = [];
    let filteredData = [];
    let currentPage = 1;
    const limit = 12;
    let currentCategory = 'all';

    const i18n = {
        en: {
            subtitle: "The directory ranked by real humans, not bots.",
            search_ph: "Try 'auto cape town' or 'tech services'...",
            theme: "üåô Theme",
            cat_all: "All", cat_auto: "üöó Auto", cat_tech: "üíª Tech", cat_health: "üè• Health", cat_service: "üõ†Ô∏è Services", cat_retail: "üõçÔ∏è Retail", cat_artists: "üé® Artists",
            global_feed: "Global Feed",
            badge_title: "üèÜ Show off your Authority",
            badge_desc: "Are you listed? Add the Fair Discovery seal to your website footer to build trust.",
            copy_code: "Copy Code",
            footer_desc: "Fair Discovery ranks websites based on verified human interaction, blocking bots to reveal true authority. This forces ad networks to deliver real traffic, not fake clicks‚Äîprotecting your budget and ensuring fair play.",
            footer_api: "Get the JSON API",
            footer_join: "Join Free on GitHub",
            support: "Support the Dev",
            lbl_auth: "Authority",
            lbl_verified: "‚úì Verified"
        },
        es: {
            subtitle: "El directorio clasificado por humanos, no bots.",
            search_ph: "Prueba 'autos madrid' o 'servicios tec'...",
            theme: "üåô Tema",
            cat_all: "Todo", cat_auto: "üöó Autos", cat_tech: "üíª Tec", cat_health: "üè• Salud", cat_service: "üõ†Ô∏è Servicios", cat_retail: "üõçÔ∏è Tiendas", cat_artists: "üé® Artistas",
            global_feed: "Feed Global",
            badge_title: "üèÜ Muestra tu Autoridad",
            badge_desc: "¬øEst√°s en la lista? A√±ade el sello de Fair Discovery a tu web.",
            copy_code: "Copiar C√≥digo",
            footer_desc: "Fair Discovery clasifica sitios web bas√°ndose en interacci√≥n humana verificada, bloqueando bots. Esto obliga a las redes publicitarias a enviar tr√°fico real y protege tu presupuesto.",
            footer_api: "Obtener API JSON",
            footer_join: "√önete gratis en GitHub",
            support: "Apoyar al Dev",
            lbl_auth: "Autoridad",
            lbl_verified: "‚úì Verificado"
        },
        fr: {
            subtitle: "L'annuaire class√© par des humains, pas des bots.",
            search_ph: "Essayez 'auto paris' ou 'services tech'...",
            theme: "üåô Th√®me",
            cat_all: "Tout", cat_auto: "üöó Auto", cat_tech: "üíª Tech", cat_health: "üè• Sant√©", cat_service: "üõ†Ô∏è Services", cat_retail: "üõçÔ∏è Commerce", cat_artists: "üé® Artistes",
            global_feed: "Flux Global",
            badge_title: "üèÜ Montrez votre Autorit√©",
            badge_desc: "Vous √™tes list√© ? Ajoutez le sceau Fair Discovery √† votre site.",
            copy_code: "Copier le Code",
            footer_desc: "Fair Discovery classe les sites selon l'interaction humaine r√©elle, en bloquant les bots. Cela force les r√©seaux publicitaires √† fournir un trafic r√©el et prot√®ge votre budget.",
            footer_api: "Obtenir l'API JSON",
            footer_join: "Rejoindre sur GitHub",
            support: "Soutenir le Dev",
            lbl_auth: "Autorit√©",
            lbl_verified: "‚úì V√©rifi√©"
        },
        de: {
            subtitle: "Das Verzeichnis von echten Menschen, nicht Bots.",
            search_ph: "Versuchen Sie 'auto berlin' oder 'tech'...",
            theme: "üåô Thema",
            cat_all: "Alle", cat_auto: "üöó Auto", cat_tech: "üíª Tech", cat_health: "üè• Gesundheit", cat_service: "üõ†Ô∏è Dienstl.", cat_retail: "üõçÔ∏è Handel", cat_artists: "üé® K√ºnstler",
            global_feed: "Globaler Feed",
            badge_title: "üèÜ Zeigen Sie Autorit√§t",
            badge_desc: "Sind Sie gelistet? F√ºgen Sie das Fair Discovery-Siegel hinzu.",
            copy_code: "Code kopieren",
            footer_desc: "Fair Discovery bewertet Websites nach echter menschlicher Interaktion und blockiert Bots. Dies zwingt Werbenetzwerke dazu, echten Traffic zu liefern und sch√ºtzt Ihr Budget.",
            footer_api: "JSON-API abrufen",
            footer_join: "Kostenlos beitreten",
            support: "Entwickler unterst√ºtzen",
            lbl_auth: "Autorit√§t",
            lbl_verified: "‚úì Verifiziert"
        },
        pt: {
            subtitle: "O diret√≥rio classificado por humanos, n√£o bots.",
            search_ph: "Tente 'auto lisboa' ou 'servi√ßos tech'...",
            theme: "üåô Tema",
            cat_all: "Tudo", cat_auto: "üöó Auto", cat_tech: "üíª Tech", cat_health: "üè• Sa√∫de", cat_service: "üõ†Ô∏è Servi√ßos", cat_retail: "üõçÔ∏è Varejo", cat_artists: "üé® Artistas",
            global_feed: "Feed Global",
            badge_title: "üèÜ Mostre sua Autoridade",
            badge_desc: "Est√° listado? Adicione o selo Fair Discovery ao seu site.",
            copy_code: "Copiar C√≥digo",
            footer_desc: "Fair Discovery classifica sites com base na intera√ß√£o humana real, bloqueando bots. Isso for√ßa as redes de an√∫ncios a entregar tr√°fego real, protegendo seu or√ßamento.",
            footer_api: "Obter API JSON",
            footer_join: "Junte-se no GitHub",
            support: "Apoie o Dev",
            lbl_auth: "Autoridade",
            lbl_verified: "‚úì Verificado"
        }
    };
    
    let currentLang = 'en';

    function changeLanguage(lang) {
        currentLang = lang;
        const dict = i18n[lang];
        
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (dict[key]) el.innerText = dict[key];
        });
        
        document.querySelectorAll('[data-i18n-ph]').forEach(el => {
            const key = el.getAttribute('data-i18n-ph');
            if (dict[key]) el.placeholder = dict[key];
        });

        render();
    }

    function toggleTheme() {
        const body = document.body;
        const isDark = body.getAttribute('data-theme') === 'dark';
        body.setAttribute('data-theme', isDark ? 'light' : 'dark');
        document.querySelector('.theme-toggle').innerText = isDark ? (currentLang === 'en' ? 'üåô Theme' : 'üåô') : (currentLang === 'en' ? '‚òÄÔ∏è Theme' : '‚òÄÔ∏è');
    }

    async function init() {
        try {
            const res = await fetch(FEED_URL + '?' + Date.now());
            const json = await res.json();
            
            const domainMap = {};
            (json.pages || []).forEach(page => {
                try {
                    const urlStr = page.url.startsWith('http') ? page.url : 'https://' + page.url;
                    const urlObj = new URL(urlStr);
                    const domain = urlObj.hostname;
                    
                    if (!domainMap[domain]) {
                        domainMap[domain] = {
                            domain: domain,
                            fullUrl: urlObj.origin,
                            totalScore: 0,
                            pageCount: 0,
                            category: page.category || inferCategory(domain), 
                            description: page.description || "Verified decentralized listing.",
                            whatsapp: page.whatsapp || null,
                            location: page.location || inferLocation(domain)
                        };
                    }
                    domainMap[domain].totalScore += page.score;
                    domainMap[domain].pageCount++;
                    
                    if (page.category && !domainMap[domain].category) domainMap[domain].category = page.category;
                    if (page.description && domainMap[domain].description.startsWith("Verified")) domainMap[domain].description = page.description;
                    
                } catch(e){}
            });

            allData = Object.values(domainMap).sort((a, b) => b.totalScore - a.totalScore);
            applyFilters();
        } catch (err) {
            document.getElementById('resultsGrid').innerHTML = `<p style="text-align:center">Database Building... Check back soon.</p>`;
        }
    }

    function inferCategory(domain) {
        const d = domain.toLowerCase();
        if (d.includes('panel') || d.includes('auto') || d.includes('motor')) return 'Auto';
        if (d.includes('tech') || d.includes('soft') || d.includes('app')) return 'Tech';
        if (d.includes('health') || d.includes('med')) return 'Health';
        if (d.includes('art') || d.includes('music') || d.includes('band') || d.includes('paint') || d.includes('design')) return 'Artists';
        return 'Service';
    }
    
    function inferLocation(domain) {
         if (domain.endsWith('.za')) return 'South Africa';
         return 'Global';
    }

    function filterCat(cat) {
        currentCategory = cat;
        document.querySelectorAll('.cat-pill').forEach(el => el.classList.remove('active'));
        event.target.classList.add('active');
        applyFilters();
    }

    function applyFilters() {
        const rawInput = document.getElementById('searchInput').value.toLowerCase();
        const searchTokens = rawInput.split(' ').filter(token => token.length > 0);
        
        filteredData = allData.filter(item => {
            const matchesCat = currentCategory === 'all' || item.category === currentCategory;
            const searchableText = `${item.domain} ${item.description} ${item.category} ${item.location}`.toLowerCase();
            const matchesSearch = searchTokens.every(token => searchableText.includes(token));
            return matchesCat && matchesSearch;
        });

        currentPage = 1;
        render();
    }

    function render() {
        const grid = document.getElementById('resultsGrid');
        grid.innerHTML = '';
        const dict = i18n[currentLang];
        
        document.getElementById('statsLabel').innerText = `Found ${filteredData.length} sites`;

        const totalPages = Math.ceil(filteredData.length / limit);
        const start = (currentPage - 1) * limit;
        const pageItems = filteredData.slice(start, start + limit);

        if (pageItems.length === 0) {
            grid.innerHTML = '<p style="text-align:center; grid-column:1/-1;">No results found.</p>';
            return;
        }

        pageItems.forEach(item => {
            let flag = 'üåê';
            if (item.domain.endsWith('.za')) flag = 'üáøüá¶';
            if (item.domain.endsWith('.uk')) flag = 'üá¨üáß';
            
            let actions = '';
            if (item.whatsapp) actions += `<a href="https://wa.me/${item.whatsapp}" target="_blank" class="btn-icon btn-whatsapp" title="WhatsApp">üí¨</a>`;
            actions += `<a href="${item.fullUrl}" target="_blank" class="btn-icon" title="Visit Site">‚Üó</a>`;

            const card = `
                <div class="card">
                    <div class="card-header">
                        <div class="card-brand">
                            <div class="card-logo">${flag}</div>
                            <div class="card-text">
                                <a href="${item.fullUrl}" target="_blank" class="card-title">${formatTitle(item.domain)}</a>
                                <span class="card-domain">${item.domain}</span>
                                <span class="verified-badge">${dict.lbl_verified}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card-desc">${item.description}</div>
                    
                    <div class="card-footer">
                        <div class="actions">${actions}</div>
                        <div class="score-box">
                            <div class="score-val">${formatScore(item.totalScore)}</div>
                            <div class="score-lbl">${dict.lbl_auth}</div>
                        </div>
                    </div>
                </div>
            `;
            grid.insertAdjacentHTML('beforeend', card);
        });

        renderPagination(totalPages);
    }

    function formatTitle(domain) {
        let t = domain.split('.')[1] || domain.split('.')[0]; 
        return t.charAt(0).toUpperCase() + t.slice(1);
    }

    function formatScore(num) {
        if (num > 1000000) return (num/1000000).toFixed(1) + 'M';
        if (num > 1000) return (num/1000).toFixed(1) + 'k';
        return num;
    }

    function renderPagination(totalPages) {
        const container = document.getElementById('paginationControls');
        container.innerHTML = '';
        if (totalPages <= 1) return;

        container.insertAdjacentHTML('beforeend', `<button class="page-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>¬´</button>`);

        for (let i = 1; i <= totalPages; i++) {
            if (totalPages > 10 && Math.abs(currentPage - i) > 2 && i !== 1 && i !== totalPages) continue; 
            container.insertAdjacentHTML('beforeend', 
                `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`
            );
        }

        container.insertAdjacentHTML('beforeend', `<button class="page-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>¬ª</button>`);
    }

    function changePage(num) { currentPage = num; render(); window.scrollTo(0, 0); }
    
    function copyBadge() {
        const copyText = document.getElementById("badgeCode");
        copyText.select();
        navigator.clipboard.writeText(copyText.value);
        alert("Code copied!");
    }

    document.getElementById('searchInput').addEventListener('input', applyFilters);
    init();
</script>

</body>
</html>
